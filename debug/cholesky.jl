include("../src/BAN.jl")
using .BAN
using LinearAlgebra
include("../../Utils/src/matrix2latex.jl")

#=
A = rand(Ban, 5,5);
AA = A*A';

A = round(A, digits=3);
AA = round(AA, digits=7);
f = cholesky(AA);

print("G = "); matrix2latex(A);
println("");

print("A = "); matrix2latex(round(AA, digits=3));
println("");

print("L = "); matrix2latex(round(f.L, digits=3));
println("");
=#

# Esempio di Benci J2

#=
G = [
0.628 - 0.629 *η - 0.195 *η*η  0.781 - 0.343 *η - 0.114 *η*η  0.457 + 0.908 *η + 0.747 *η*η  0.367 + 0.733 *η + 0.582 *η*η  0.685 - 0.481 *η - 0.054 *η*η ;
0.419 + 0.383 *η - 0.802 *η*η  0.815 + 0.765 *η - 0.952 *η*η  0.145 + 0.614 *η + 0.662 *η*η  0.457 + 0.127 *η - 0.918 *η*η  0.04  + 0.783 *η - 0.899 *η*η ;
0.966 - 0.733 *η + 0.953 *η*η  0.191 + 0.81  *η + 0.109 *η*η  0.36  - 0.751 *η - 0.205 *η*η  0.224 - 0.167 *η + 0.272 *η*η  0.749 - 0.035 *η - 0.696 *η*η ;
0.311 + 0.213 *η - 0.56  *η*η  0.621 + 0.372 *η + 0.241 *η*η  0.784 + 0.888 *η - 0.934 *η*η  0.113 + 0.584 *η - 0.704 *η*η  0.27  + 0.733 *η + 0.949 *η*η ;
0.505 - 0.242 *η + 0.617 *η*η  0.808 + 0.984 *η + 0.379 *η*η  0.724 - 0.438 *η + 0.844 *η*η  0.472 - 0.053 *η + 0.274 *η*η  0.046 - 0.211 *η - 0.353 *η*η
]
=#

A = [
1.819 - 0.617 *η + 2.719 *η*η  1.162 + 1.606 *η - 1.93  *η*η  1.516 - 0.798 *η - 0.243 *η*η  1.266 + 1.803 *η + 0.927 *η*η  1.484 + 0.639 *η + 1.029 *η*η ;
1.162 + 1.606 *η - 1.93  *η*η  1.072 + 1.925 *η - 1.206 *η*η  0.746 + 1.517 *η - 1.214 *η*η  0.813 + 2.119 *η + 0.432 *η*η  1.193 + 1.956 *η - 0.15  *η*η ;
1.516 - 0.798 *η - 0.243 *η*η  0.746 + 1.517 *η - 1.214 *η*η  1.71  - 1.773 *η + 2.6   *η*η  0.929 + 0.934 *η - 0.876 *η*η  1.043 - 0.713 *η + 2.607 *η*η ;
1.266 + 1.803 *η + 0.927 *η*η  0.813 + 2.119 *η + 0.432 *η*η  0.929 + 0.934 *η - 0.876 *η*η  1.183 + 2.514 *η + 0.689 *η*η  1.292 + 1.489 *η - 0.289 *η*η ;
1.484 + 0.639 *η + 1.029 *η*η  1.193 + 1.956 *η - 0.15  *η*η  1.043 - 0.713 *η + 2.607 *η*η  1.292 + 1.489 *η - 0.289 *η*η  1.657 + 0.642 *η + 3.951 *η*η
];

L = [
1.349 - 0.229 *η + 0.989 *η*η  0  0  0  0 ;
0.862 + 1.337 *η - 1.836 *η*η   0.574 - 0.33  *η + 0.053 *η*η  0  0  0 ;
1.125 - 0.401 *η - 1.073 *η*η  -0.389 + 0.402 *η + 4.297 *η*η   0.542 - 0.514 *η + 7.163 *η*η  0  0 ;
0.938 + 1.496 *η + 0.253 *η*η   0.008 - 0.736 *η - 0.535 *η*η  -0.227 - 1.436 *η + 2.566 *η*η  0.5   - 0.934 *η - 4.322 *η*η  0 ;
1.101 + 0.66  *η + 0.068 *η*η   0.427 + 0.098 *η + 1.637 *η*η  -0.053 - 2.166 *η + 3.696 *η*η  0.488 - 1.151 *η - 4.865 *η*η  0.152 - 0.001 *η + 3.545 *η*η
];

LL = L*L'; matrix2latex(round(LL, digits=4));
println("");

norm_A = norm(A);
print("Norm A: "); print_ext(norm_A); println("")

norm_diff = norm(A-LL);
print("Norm diff: "); print_ext(norm_diff);
